<style>
    /* Izohlar Paneli (Modal kabi lekin pastdan chiqadi) */
.comment-overlay {
    position: fixed;
    bottom: -100%; /* Dastlab ko'rinmaydi */
    left: 0;
    width: 100%;
    height: 80vh; /* Ekranning 80% qismini egallaydi */
    background: white;
    z-index: 2001;
    border-radius: 30px 30px 0 0;
    box-shadow: 0 -10px 40px rgba(0,0,0,0.15);
    transition: bottom 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
}

.comment-overlay.active {
    bottom: 0;
}

/* Panelning tepa qismi (Header) */
.comment-header {
    padding: 20px;
    border-bottom: 1px solid #f1f5f9;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.comment-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 800;
}

.back-btn {
    background: #f1f5f9;
    border: none;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Izohlar ro'yxati (Scroll bo'ladigan joy) */
.comments-body {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

.comment-item {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    animation: fadeIn 0.3s ease;
}

.comment-item img {
    width: 38px;
    height: 38px;
    border-radius: 12px;
    object-fit: cover;
}

.comment-content {
    background: #f8fafc;
    padding: 12px 16px;
    border-radius: 0 18px 18px 18px;
    flex: 1;
}

.comment-content b {
    display: block;
    font-size: 14px;
    color: var(--primary);
    margin-bottom: 4px;
}

.comment-text {
    font-size: 14px;
    color: var(--text-dark);
    line-height: 1.5;
}

/* Orqa fonni xiralashtirish (Backdrop) */
.panel-backdrop {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(15, 23, 42, 0.4);
    backdrop-filter: blur(4px);
    z-index: 2000;
    display: none;
}
</style>
<div class="panel-backdrop" id="panelBackdrop" onclick="closeComments()"></div>

<div class="comment-overlay" id="commentPanel">
    <div class="comment-header">
        <button class="back-btn" onclick="closeComments()">
            <i class="bi bi-chevron-down"></i> </button>
        <h3>Izohlar ({{ post.comments.count }})</h3>
        <div style="width: 35px;"></div> </div>

    <div class="comments-body">
        {% for comment in post.comments.all %}
        <div class="comment-item">
            <img src="https://i.pravatar.cc/100?u={{ comment.user.id }}">
            <div class="comment-content">
                <b>@{{ comment.user.username }}</b>
                <div class="comment-text">{{ comment.text }}</div>
                <span style="color: #94a3b8; font-size: 11px; margin-top: 5px; display: inline-block;">
                    <i class="bi bi-clock"></i> {{ comment.created_at|timesince }} oldin
                </span>
            </div>
        </div>
        {% empty %}
        <p style="text-align: center; color: gray;">Hali izohlar yo'q. Birinchi bo'lib yozing!</p>
        {% endfor %}
    </div>

    <div class="comment-wrapper" style="border-top: 1px solid #f1f5f9; padding: 20px;">
        <form action="" method="post">
            {% csrf_token %}
            <div class="comment-input-container">
                <input type="text" name="comment_text" placeholder="Fikringizni yozing...">
                <button type="submit" class="send-btn">
                    <i class="bi bi-send-fill"></i>
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    function openComments() {
    document.getElementById('commentPanel').classList.add('active');
    document.getElementById('panelBackdrop').style.display = 'block';
    document.body.style.overflow = 'hidden'; // Asosiy sahifani qotirib qo'yadi
}

function closeComments() {
    document.getElementById('commentPanel').classList.remove('active');
    document.getElementById('panelBackdrop').style.display = 'none';
    document.body.style.overflow = 'auto'; // Sahifani yana ochadi
}
</script>